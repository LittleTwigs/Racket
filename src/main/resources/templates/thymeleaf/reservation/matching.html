<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{thymeleaf/layout/mainLayout}">
<head>
<title>예약 참여하기</title>
<meta charset="utf-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, user-scalable=no" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="stylesheet" href="/racket/common/assets/css/main.css" />
<link rel="stylesheet" href="/racket/common/css/side.css" />
<noscript>
	<link rel="stylesheet" href="/racket/common/assets/css/noscript.css" />
</noscript>

<!-- 달력 -->
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link
	href="https://fonts.googleapis.com/css?family=Roboto:300,400&display=swap"
	rel="stylesheet">

<link
	href="https://fonts.googleapis.com/css?family=Poppins:300,400,500&display=swap"
	rel="stylesheet">


<link rel="stylesheet"
	href="/racket/common/assets/fonts/icomoon/style.css">

<link rel="stylesheet" href="/racket/common/assets/css/rome.css">

<!-- Bootstrap CSS -->
<link rel="stylesheet"
	href="/racket/common/assets/css/bootstrap.min.css">

<!-- Style -->
<link rel="stylesheet" href="/racket/common/assets/css/style.css">

<style type="text/css">
.error-message {
    color: red;
    font-size: 12px;
    margin-top: 5px;
}
</style>

<script type="text/javascript">
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.querySelector('form'); // 폼 요소 선택

    // 폼 제출 시 이벤트 핸들러
    form.addEventListener('submit', function(event) {
      const matchingDateInput = document.getElementById('input'); // 대여 날짜 입력 필드 선택
      const matchingHourInput = document.querySelector('select[name="courtHourNo"]'); // 대여시간 선택 필드 선택

      const errorMessageMatchingDate = matchingDateInput.nextElementSibling; // 대여 날짜 에러 메시지 요소 선택
      const errorMessageMatchingHour = matchingHourInput.nextElementSibling; // 대여 시간 에러 메시지 요소 선택

      // 기존 에러 메시지 초기화
      errorMessageMatchingDate.textContent = '';
      errorMessageMatchingHour.textContent = '';

      let hasError = false; // 에러 여부를 저장하는 변수

      // 대여 날짜 필드 확인
      if (matchingDateInput.value === '') {
        hasError = true;
        errorMessageMatchingDate.textContent = '* 참여할 날짜를 선택해주세요.'; // 에러 메시지 표시
      }

      // 대여시간 필드 확인
      if (matchingHourInput.value === '') {
        hasError = true;
        errorMessageMatchingHour.textContent = '* 참여할 시간을 선택해주세요.'; // 에러 메시지 표시
      }

      if (hasError) {
        event.preventDefault(); // 폼 제출 방지
      }
    });
  });
</script>

</head>
<body class="is-preload">

	<th:block layout:fragment="content">


	<!-- Wrapper -->
	<div id="wrapper" style="margin:50px; margin-top: 180px;">
	<!-- Form -->
	<div class="col-lg-4" style="position: relative; float: right;" id="scroll">
		<div class="box" style="padding: 20px; margin: 0px;">
			<form method="post" action="/racket/matching/insert">
			
			<!-- 임시 id값 -->
			<input type="hidden" name="memberId" th:value="${#session.getAttribute('user').memberId}">
			<input type="hidden" name="memberGender" th:value="${#session.getAttribute('user').memberGender}">
			<input type="hidden" name="totalAmount" id="totalAmount" onchange="handleRadioChange()" value="0" >
			<input type="hidden" name="reservationFee" id="reservationFee" onchange="handleRadioChange()" value="0" >
			

				<div class="field">
					<div class="form-group">
						<input type="text" class="priority-low" id="input" style="text-align: center;" placeholder="대여 날짜"  name="matchDate" >
							<span class="error-message" id="errorMessageMatchingDate"></span>
					</div>
				</div>


				<div class="field">
					<select name="courtHourNo" id="department"
						style="text-align: center;">
						<option value="" disabled selected>- 대여시간 -</option>
						<option th:each="hour : ${reservation.courtOperatingHours}" th:text="${hour.courtStart + ':00 ~ ' + hour.courtEnd + ':00'}" 
         th:sorted="${true}" th:sortby="hour.courtStart"></option>
					</select>
					<span class="error-message" id="errorMessageMatchingHour"></span>
				</div>

				<br /><!-- <br />

				경기방식
				<div class="field" style="text-align: center;">
					<input type="radio" id="priority-low" name="reservationMet" value="2" disabled selected checked /> <label
						for="priority-low">단식</label> <input type="radio"
						id="priority-normal" name="reservationMet" value="4"  disabled selected/> <label
						for="priority-normal">복식</label>
				</div>
				<br />

				성별
				<div class="field" style="text-align: center;">
<input type="radio" id="woman" name="reservationGender" value="여성" disabled selected checked /> <label for="woman">여성</label>
<input type="radio" id="man" name="reservationGender" value="남성"  disabled selected/> <label for="man">남성</label>
<input type="radio" id="mixing" name="reservationGender" value="혼합"  disabled selected/> <label for="mixing">혼합</label>
				</div>
				<br /> -->
				
				<div class="field">
					<div class="box" style="padding: 15px;">
						<p style="text-align: center; color: black;">
							경기 방식
							<code style="color: #134C43"><span th:text="${reservation.reservationMet + ' / ' + reservation.reservationGender}"></span></code>
						</p>
					</div>
				</div>
				
				<div class="field">
					<div class="box" style="padding: 15px;">
						<p style="text-align: center; color: black;">
							등급 제한
							<code style="color: #134C43"><span th:text="${reservation.gradeSetting}"></span></code>
						</p>
					</div>
				</div>

				<div class="field">
					<div class="box" style="padding: 15px;">
						<p style="text-align: center; color: black;">
							참여 인원
							<code style="color: #134C43"><span th:text="${participantCount}"></span> / <span th:text="${reservation.peopleNum}"></span></code>
							명
						</p>
					</div>
				</div>

				<div class="field">
					<div class="box" style="padding: 15px;">
						<p style="text-align: center; color: black;"><span th:text="${reservation.reservationFee} +'원'"></span></p>
					</div>
				</div>

				<div class="field" style="text-align: center;" th:if="${participantCount &gt;= reservation.peopleNum}">
				    <input type="submit" name="submit" id="submit" value="예약하기" disabled="disabled" />
				</div>
				<div class="field" style="text-align: center;">
					<input type="submit" name="submit" id="submit" value="예약하기" />
				</div>

			</form>

		</div>
	</div>


	<div class="col-lg-8" style="position: relative; float: right; padding: 0px;"id="reservation">

		<div class="image fit">
			<!-- 체육관 사진 -->
			<div class="swiper mySwiper">
				<div class="swiper-wrapper">
					<div class="swiper-slide" th:each="file : ${reservation.courtOperatingHours.court.stadium.files}">
						<img th:src="${file.fileStorename[0]}" alt="Stadium Image">
					</div>
					<!-- 대체 이미지 -->
				       <div th:if="${reservation.courtOperatingHours.court.stadium.files.size() == 0}">
				           <img src="/racket/images/reservationPark.jpg" alt="Alternative Image">
			        </div>
				</div>
				<div class="swiper-button-next"></div>
				<div class="swiper-button-prev"></div>
				<div class="swiper-pagination"></div>
			</div>
		</div>

		<section>
			<div class="box">
				<blockquote><h3>체육관 정보</h3></blockquote>
				<p style="color: black;">구장 이름 : <span th:text="${reservation.courtOperatingHours.court.stadium.stadiumName}"></span></p>
				<p style="color: black;">코트 번호 : <span th:text="${reservation.courtOperatingHours.court.courtName}"></span></p>
				<p style="color: black;">구장 주소 : <span th:text="${reservation.courtOperatingHours.court.stadium.stadiumAddr}"></span></p>
				<p style="color: black;">운영 시간 : <span th:text="${reservation.courtOperatingHours.court.stadium.stadiumTime}"></span></p>
				<p style="color: black;">전화번호 : <span th:text="${reservation.courtOperatingHours.court.stadium.stadiumTel}"></span></p>
				<p style="color: black;">시간당 가격 : <span id="stadiumFee" th:value="${reservation.courtOperatingHours.court.stadium.stadiumFee}" th:text="${reservation.courtOperatingHours.court.stadium.stadiumFee}"></span>원</p>
				<p style="color: black;">구장 소개 : <span th:text="${reservation.courtOperatingHours.court.stadium.stadiumContent}"></span></p>
			</div>
		</section>
		
		<!-- 강사 정보 -->
		<section>
			<div class="box">
				<blockquote><h3>예약</h3></blockquote>
				<p style="color: black;">예약자 : <span th:text="${reservation.member.memberName}"></span></p>
				<p style="color: black;">경기 방식 : <span th:text="${reservation.reservationMet + ' / ' + reservation.reservationGender}"></span></p>
				<p style="color: black;">등급 제한 : <span th:text="${reservation.gradeSetting}"></span></p>
				<p style="color: black;">구장비 : <span th:text="${reservation.reservationFee}+'원'"></span></p>
				<p style="color: black;">모집 내용 : <span th:text="${reservation.reservationContent}"></span></p>
			</div>
		</section>
	</div>

	<!-- Scripts -->
	<script src="/racket/common/assets/js/jquery.min.js"></script>
	<script src="/racket/common/assets/js/jquery.scrollex.min.js"></script>
	<script src="/racket/common/assets/js/jquery.scrolly.min.js"></script>
	<script src="/racket/common/assets/js/browser.min.js"></script>
	<script src="/racket/common/assets/js/breakpoints.min.js"></script>
	<script src="/racket/common/assets/js/util.js"></script>
	<script src="/racket/common/assets/js/main.js"></script>
	<script src="/racket/common/assets/js/scroll.js"></script>

	<!-- Note: Only needed for demo purposes. Delete for production sites. -->
	<script src="/racket/common/assets/js/demo.js"></script>


	<!-- 달력 -->
	<script src="/racket/common/assets/js/jquery-3.3.1.min.js"></script>
	<script src="/racket/common/assets/js/popper.min.js"></script>
	<script src="/racket/common/assets/js/bootstrap.min.js"></script>
	<script src="/racket/common/assets/js/rome.js"></script>
	<script src="/racket/common/assets/js/main.js"></script>
</div>
</th:block>
</body>
</html>